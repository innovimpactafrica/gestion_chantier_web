<!-- Sidebar avec largeur fixe -->

<!-- Contenu principal avec marge gauche égale à la largeur du sidebar -->
<div class="p-6 bg-gray-50 min-h-screen">
  <!-- Header -->
  <div class="flex justify-between items-center mb-8">
    <h1 class="text-2xl font-semibold text-gray-900">Tableau de bord</h1>
    <div class="flex items-center space-x-2">
      <span class="text-lg font-medium text-gray-700">{{ currentYear }}</span>
      <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
      </svg>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    <!-- En Attente -->
    <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm text-gray-600 mb-1">En attente de validation</p>
          <p class="text-3xl font-bold text-gray-900">{{ stats.enAttente.toString().padStart(2, '0') }}</p>
        </div>
        <div class="w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M10 18C12.1217 18 14.1566 17.1571 15.6569 15.6569C17.1571 14.1566 18 12.1217 18 10C18 7.87827 17.1571 5.84344 15.6569 4.34315C14.1566 2.84285 12.1217 2 10 2C7.87827 2 5.84344 2.84285 4.34315 4.34315C2.84285 5.84344 2 7.87827 2 10C2 12.1217 2.84285 14.1566 4.34315 15.6569C5.84344 17.1571 7.87827 18 10 18ZM10 0C11.3132 0 12.6136 0.258658 13.8268 0.761205C15.0401 1.26375 16.1425 2.00035 17.0711 2.92893C17.9997 3.85752 18.7362 4.95991 19.2388 6.17317C19.7413 7.38642 20 8.68678 20 10C20 12.6522 18.9464 15.1957 17.0711 17.0711C15.1957 18.9464 12.6522 20 10 20C4.47 20 0 15.5 0 10C0 7.34784 1.05357 4.8043 2.92893 2.92893C4.8043 1.05357 7.34784 0 10 0ZM10.5 5V10.25L15 12.92L14.25 14.15L9 11V5H10.5Z"
              fill="#F59E0C" />
          </svg>

        </div>
      </div>
    </div>

    <!-- En Cours -->
    <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm text-gray-600 mb-1">En cours de livraison</p>
          <p class="text-3xl font-bold text-gray-900">{{ stats.enCours.toString().padStart(2, '0') }}</p>
        </div>
        <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M12.9969 2.03003V4.05003C17.3869 4.59003 20.4969 8.58003 19.9569 12.97C19.4969 16.61 16.6369 19.5 12.9969 19.93V21.93C18.4969 21.38 22.4969 16.5 21.9469 11C21.4969 6.25003 17.7269 2.50003 12.9969 2.03003ZM10.9969 2.06003C9.04688 2.25003 7.18688 3.00003 5.66688 4.26003L7.09688 5.74003C8.21688 4.84003 9.56687 4.26003 10.9969 4.06003V2.06003ZM4.25688 5.67003C3.00732 7.18785 2.23797 9.04334 2.04688 11H4.04688C4.23688 9.58003 4.79688 8.23003 5.68688 7.10003L4.25688 5.67003ZM2.05687 13C2.25687 14.96 3.02688 16.81 4.26688 18.33L5.68688 16.9C4.80372 15.7697 4.24073 14.4227 4.05687 13H2.05687ZM7.09688 18.37L5.66688 19.74C7.18184 21.0024 9.03624 21.7887 10.9969 22V20C9.57425 19.8162 8.22723 19.2532 7.09688 18.37ZM12.4969 7.00003V12.25L16.9969 14.92L16.2469 16.15L10.9969 13V7.00003H12.4969Z"
              fill="#3B83F6" />
          </svg>
        </div>
      </div>
    </div>

    <!-- Validées -->
    <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm text-gray-600 mb-1">Livrées</p>
          <p class="text-3xl font-bold text-gray-900">{{ stats.validees.toString().padStart(2, '0') }}</p>
        </div>
        <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M10.6 13.8L8.45 11.65C8.26667 11.4667 8.03333 11.375 7.75 11.375C7.46667 11.375 7.23334 11.4667 7.05 11.65C6.86667 11.8333 6.775 12.0667 6.775 12.35C6.775 12.6333 6.86667 12.8667 7.05 13.05L9.9 15.9C10.1 16.1 10.3333 16.2 10.6 16.2C10.8667 16.2 11.1 16.1 11.3 15.9L16.95 10.25C17.1333 10.0667 17.225 9.83333 17.225 9.55C17.225 9.26667 17.1333 9.03333 16.95 8.85C16.7667 8.66667 16.5333 8.575 16.25 8.575C15.9667 8.575 15.7333 8.66667 15.55 8.85L10.6 13.8ZM12 22C10.6167 22 9.31667 21.7373 8.1 21.212C6.88334 20.6867 5.825 19.9743 4.925 19.075C4.025 18.1757 3.31267 17.1173 2.788 15.9C2.26333 14.6827 2.00067 13.3827 2 12C1.99933 10.6173 2.262 9.31733 2.788 8.1C3.314 6.88267 4.02633 5.82433 4.925 4.925C5.82367 4.02567 6.882 3.31333 8.1 2.788C9.318 2.26267 10.618 2 12 2C13.382 2 14.682 2.26267 15.9 2.788C17.118 3.31333 18.1763 4.02567 19.075 4.925C19.9737 5.82433 20.6863 6.88267 21.213 8.1C21.7397 9.31733 22.002 10.6173 22 12C21.998 13.3827 21.7353 14.6827 21.212 15.9C20.6887 17.1173 19.9763 18.1757 19.075 19.075C18.1737 19.9743 17.1153 20.687 15.9 21.213C14.6847 21.739 13.3847 22.0013 12 22ZM12 20C14.2333 20 16.125 19.225 17.675 17.675C19.225 16.125 20 14.2333 20 12C20 9.76667 19.225 7.875 17.675 6.325C16.125 4.775 14.2333 4 12 4C9.76667 4 7.875 4.775 6.325 6.325C4.775 7.875 4 9.76667 4 12C4 14.2333 4.775 16.125 6.325 17.675C7.875 19.225 9.76667 20 12 20Z"
              fill="#22C55F" />
          </svg>

        </div>
      </div>
    </div>

    <!-- Rejetées -->
    <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm text-gray-600 mb-1">Validées</p>
          <p class="text-3xl font-bold text-gray-900">{{ stats.rejetees.toString().padStart(2, '0') }}</p>
        </div>
        <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M10.6 13.8L8.45 11.65C8.26667 11.4667 8.03333 11.375 7.75 11.375C7.46667 11.375 7.23334 11.4667 7.05 11.65C6.86667 11.8333 6.775 12.0667 6.775 12.35C6.775 12.6333 6.86667 12.8667 7.05 13.05L9.9 15.9C10.1 16.1 10.3333 16.2 10.6 16.2C10.8667 16.2 11.1 16.1 11.3 15.9L16.95 10.25C17.1333 10.0667 17.225 9.83333 17.225 9.55C17.225 9.26667 17.1333 9.03333 16.95 8.85C16.7667 8.66667 16.5333 8.575 16.25 8.575C15.9667 8.575 15.7333 8.66667 15.55 8.85L10.6 13.8ZM12 22C10.6167 22 9.31667 21.7373 8.1 21.212C6.88334 20.6867 5.825 19.9743 4.925 19.075C4.025 18.1757 3.31267 17.1173 2.788 15.9C2.26333 14.6827 2.00067 13.3827 2 12C1.99933 10.6173 2.262 9.31733 2.788 8.1C3.314 6.88267 4.02633 5.82433 4.925 4.925C5.82367 4.02567 6.882 3.31333 8.1 2.788C9.318 2.26267 10.618 2 12 2C13.382 2 14.682 2.26267 15.9 2.788C17.118 3.31333 18.1763 4.02567 19.075 4.925C19.9737 5.82433 20.6863 6.88267 21.213 8.1C21.7397 9.31733 22.002 10.6173 22 12C21.998 13.3827 21.7353 14.6827 21.212 15.9C20.6887 17.1173 19.9763 18.1757 19.075 19.075C18.1737 19.9743 17.1153 20.687 15.9 21.213C14.6847 21.739 13.3847 22.0013 12 22ZM12 20C14.2333 20 16.125 19.225 17.675 17.675C19.225 16.125 20 14.2333 20 12C20 9.76667 19.225 7.875 17.675 6.325C16.125 4.775 14.2333 4 12 4C9.76667 4 7.875 4.775 6.325 6.325C4.775 7.875 4 9.76667 4 12C4 14.2333 4.775 16.125 6.325 17.675C7.875 19.225 9.76667 20 12 20Z"
              fill="#155724" />
          </svg>

        </div>
      </div>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Pie Chart -->
    <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-lg font-semibold text-gray-900">Répartition des études (%)</h3>
        <div class="relative">
          <select [(ngModel)]="selectedPeriod" (change)="onPeriodChange(selectedPeriod)"
            class="appearance-none bg-gray-50 border border-gray-300 rounded-md px-3 py-2 pr-8 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="Ce-mois">Ce-mois</option>
            <option value="Ce-trimestre">Ce-trimestre</option>
            <option value="Cette-année">Cette-année</option>
          </select>
          <svg class="absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"
            fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </div>
      </div>

      <!-- Graphique centré -->
      <div class="flex justify-center mb-8">
        <div class="w-64 h-64 relative">
          <canvas #pieChart></canvas>
        </div>
      </div>

      <!-- Légende en bas, organisée en 2 colonnes -->
      <div class="grid grid-cols-2 gap-4 max-w-md mx-auto">
        <div class="flex items-center">
          <div class="w-3 h-3 bg-amber-500 rounded-full mr-3"></div>
          <span class="text-sm text-gray-600">Attente • {{ getPercentage(stats.enAttente) }}%</span>
        </div>
        <div class="flex items-center">
          <div class="w-3 h-3 bg-blue-500 rounded-full mr-3"></div>
          <span class="text-sm text-gray-600">En cours • {{ getPercentage(stats.enCours) }}%</span>
        </div>
        <div class="flex items-center">
          <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
          <span class="text-sm text-gray-600">Validées • {{ getPercentage(stats.validees) }}%</span>
        </div>
        <div class="flex items-center">
          <div class="w-3 h-3 bg-red-500 rounded-full mr-3"></div>
          <span class="text-sm text-gray-600">Rejetées • {{ getPercentage(stats.rejetees) }}%</span>
        </div>
      </div>
    </div>

    <!-- Bar Chart -->
    <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-lg font-semibold text-gray-900">Volumétrie</h3>
        <div class="relative">
          <select [(ngModel)]="selectedVolumePeriod" (change)="onVolumePeriodChange(selectedVolumePeriod)"
            class="appearance-none bg-gray-50 border border-gray-300 rounded-md px-3 py-2 pr-8 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="Ce-mois">Ce-mois</option>
            <option value="Ce-trimestre">Ce-trimestre</option>
            <option value="Cette-année">Cette-année</option>
          </select>
          <svg class="absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"
            fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </div>
      </div>

      <div class="h-64">
        <canvas #barChart></canvas>
      </div>
    </div>
  </div>
</div>

<!-- le ts -->